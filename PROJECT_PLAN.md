# Project Deployment Plan

## Prerequisites
- Debian/Ubuntu VPS (`morphvm_se3e225a`) with root access.
- Node.js v20 installed.
- Nginx installed.
- PM2 installed globally (`npm install -g pm2`).
- GitHub OAuth token (already configured as remote).

## 1. Clone the repository (already present on the VPS)
```bash
cd /root
# If the repo is not yet cloned, run:
# git clone https://x-access-token:<TOKEN>@github.com/oscar-fern-labs/project-webapp.git
cd project-webapp
```

## 2. Backend setup
```bash
cd backend
npm install   # installs Express
# Start the backend with PM2
pm2 start index.js --name webapp-backend
# Save the PM2 process list and configure startup
pm2 save
pm2 startup systemd -u root --hp /root
```

## 3. Frontend setup
The frontend consists of static files in `frontend/`. No build step required.
Make sure the files are readable by Nginx (owned by root, permission 644).

## 4. Nginx configuration
Create a site configuration at `/etc/nginx/sites-available/project-webapp`:
```nginx
server {
    listen 80;
    server_name _;

    root /root/project-webapp/frontend;
    index index.html;

    # Serve static assets
    location / {
        try_files $uri $uri/ =404;
    }

    # Proxy API requests to the backend
    location /api/ {
        proxy_pass http://127.0.0.1:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}
```
Enable the site and reload Nginx:
```bash
ln -s /etc/nginx/sites-available/project-webapp /etc/nginx/sites-enabled/
nginx -t && systemctl reload nginx
```

## 5. Verify deployment
- Open a browser to `http://<VPS_IP>/` â€“ you should see the frontend UI.
- Check health endpoint:
```bash
curl http://<VPS_IP>/api/health
```
  Expected output: `{ "status": "ok" }`
- Test CRUD operations with `curl` or the UI.

## 6. Persistence
PM2 will automatically restart the backend on reboot because of the `pm2 startup` command and the saved process list.

---
*Generated by the Fern deployment agent.*

